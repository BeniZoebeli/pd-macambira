import glob
import os
import re
prefix = "/usr/local/lib/pd"

env = Environment(CPPPATH = Split(prefix + '/src /usr/local/include . src'), CPPDEFINES=['PD', 'UNIX'], SHLIBPREFIX = '', SHLIBSUFFIX = '.pd_linux', CCFLAGS = '-pipe -O2')

# C sources in src/
for extra in glob.glob('src/*.c'):
    external = env.SharedLibrary(re.sub("\.c$","",os.path.basename(extra)), extra)
    env.Alias('install', env.Install(os.path.join(prefix, 'extra'), external))
    Default(external)
env.Alias('install', env.Install(os.path.join(prefix, 'doc/5.reference'), glob.glob('doc/*.pd')))

# libraries
Export('env prefix')
for subdir in Split('../miXed ../zexy'):
    SConscript (subdir + '/SConscript')
